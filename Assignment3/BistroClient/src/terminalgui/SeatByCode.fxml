<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="terminalgui.SeatByCodeController"
            stylesheets="@/styles/terminal.css"
            styleClass="terminal-bg"
            prefWidth="1100" prefHeight="750">

    <!-- Top bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="12" styleClass="terminal-topbar">
            <padding>
                <Insets top="18" right="26" bottom="18" left="26"/>
            </padding>

            <VBox spacing="4">
                <Label text="Get Your Table" styleClass="terminal-title"/>
                <Label text="Check in with your reservation" styleClass="terminal-subtitle"/>
            </VBox>

            <Pane HBox.hgrow="ALWAYS"/>

            <Button text="â† Back" onAction="#onBack" styleClass="btn-secondary" prefHeight="42" prefWidth="100"/>
        </HBox>
    </top>

    <!-- Center -->
    <center>
        <HBox alignment="CENTER" spacing="24">
            <padding>
                <Insets top="20" right="30" bottom="30" left="30"/>
            </padding>

            <!-- LEFT CARD: Enter Code Manually (for everyone) -->
            <VBox styleClass="terminal-card" spacing="20" prefWidth="320" minHeight="580">
                <padding>
                    <Insets top="28" right="28" bottom="28" left="28"/>
                </padding>

                <!-- Header -->
                <VBox spacing="6">
                    <Label text="ðŸŽŸï¸ Enter Code" style="-fx-font-size: 20px; -fx-font-weight: 700; -fx-text-fill: #1e293b;"/>
                    <Label text="For all customers"
                           style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                </VBox>

                <Separator style="-fx-background-color: #e2e8f0;"/>

                <!-- Code Input -->
                <VBox spacing="10">
                    <Label text="Confirmation Code" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #334155;"/>
                    <TextField fx:id="codeField"
                               promptText="e.g. RES12345678"
                               prefHeight="50"
                               style="-fx-background-radius: 10; -fx-border-radius: 10; -fx-border-color: #cbd5e1; -fx-padding: 0 14; -fx-font-size: 16px;"/>
                </VBox>

                <!-- Seat Button -->
                <Button text="Seat Me"
                        onAction="#onSeat"
                        styleClass="btn-primary"
                        prefHeight="50"
                        maxWidth="Infinity"/>

                <!-- Status -->
                <Label fx:id="statusLabel"
                       text="Enter your confirmation code above"
                       wrapText="true"
                       style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>

                <Pane VBox.vgrow="ALWAYS"/>

                <!-- Result Display -->
                <VBox spacing="8"
                      style="-fx-background-color: linear-gradient(to bottom right, #f0fdf4, #dcfce7); 
                             -fx-background-radius: 12; -fx-padding: 20; 
                             -fx-border-color: #bbf7d0; -fx-border-radius: 12;">
                    <Label text="Your Table"
                           style="-fx-text-fill: #166534; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                    <Label fx:id="resultLabel"
                           text=""
                           style="-fx-text-fill: #14532d; -fx-font-weight: 900; -fx-font-size: 26px;"/>
                </VBox>

                <!-- Forgot Code Link -->
                <Hyperlink text="Forgot your code?" onAction="#onForgotCode"
                           style="-fx-text-fill: #0369a1; -fx-font-size: 12px;"/>
            </VBox>

            <!-- RIGHT CARD: Subscriber Options (Card or Login) -->
            <VBox styleClass="terminal-card" spacing="14" prefWidth="520" minHeight="580">
                <padding>
                    <Insets top="24" right="24" bottom="24" left="24"/>
                </padding>

                <!-- Header -->
                <VBox spacing="4">
                    <Label text="ðŸ‘¤ Subscriber Check-In" style="-fx-font-size: 20px; -fx-font-weight: 700; -fx-text-fill: #1e293b;"/>
                    <Label text="Identify yourself to see your reservations"
                           style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                </VBox>

                <Separator style="-fx-background-color: #e2e8f0;"/>

                <!-- TabPane for Card / Login -->
                <TabPane fx:id="subscriberTabPane" tabClosingPolicy="UNAVAILABLE" 
                         style="-fx-background-color: transparent;" prefHeight="170">
                    
                    <!-- TAB 1: Membership Card -->
                    <Tab text="ðŸ“‡ Membership Card">
                        <VBox spacing="12" style="-fx-padding: 14 0 0 0;">
                            <Label text="Scan or enter your membership card code"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                            
                            <VBox spacing="6">
                                <Label text="Card Code" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #334155;"/>
                                <TextField fx:id="memberCardField"
                                           promptText="e.g. QR-XXXXXXXX"
                                           prefHeight="44"
                                           style="-fx-background-radius: 10; -fx-border-radius: 10; -fx-border-color: #cbd5e1; -fx-padding: 0 14; -fx-font-size: 14px;"/>
                            </VBox>

                            <Button text="Load My Reservations"
                                    onAction="#onLoadReservations"
                                    styleClass="btn-secondary"
                                    prefHeight="42"
                                    maxWidth="Infinity"/>
                        </VBox>
                    </Tab>

                    <!-- TAB 2: Login -->
                    <Tab text="ðŸ” Login">
                        <VBox spacing="10" style="-fx-padding: 14 0 0 0;">
                            <Label text="Login with your account credentials"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                            
                            <HBox spacing="12">
                                <VBox spacing="4" HBox.hgrow="ALWAYS">
                                    <Label text="Email" style="-fx-font-weight: 600; -fx-font-size: 12px; -fx-text-fill: #334155;"/>
                                    <TextField fx:id="loginEmailField"
                                               promptText="your@email.com"
                                               prefHeight="40"
                                               style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #cbd5e1; -fx-padding: 0 12; -fx-font-size: 13px;"/>
                                </VBox>

                                <VBox spacing="4" HBox.hgrow="ALWAYS">
                                    <Label text="Password" style="-fx-font-weight: 600; -fx-font-size: 12px; -fx-text-fill: #334155;"/>
                                    <PasswordField fx:id="loginPasswordField"
                                                   promptText="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                                   prefHeight="40"
                                                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #cbd5e1; -fx-padding: 0 12; -fx-font-size: 13px;"/>
                                </VBox>
                            </HBox>

                            <Button text="Login &amp; Load Reservations"
                                    onAction="#onLoginAndLoad"
                                    styleClass="btn-secondary"
                                    prefHeight="40"
                                    maxWidth="Infinity"/>
                        </VBox>
                    </Tab>
                </TabPane>

                <!-- Reservations Table - LARGER -->
                <VBox spacing="8" VBox.vgrow="ALWAYS">
                    <Label text="Your Reservations" style="-fx-font-weight: 700; -fx-font-size: 14px; -fx-text-fill: #334155;"/>
                    <TableView fx:id="reservationsTable" VBox.vgrow="ALWAYS" minHeight="180"
                               style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #e2e8f0; -fx-font-size: 13px;">
                        <columns>
                            <TableColumn fx:id="dateCol" text="Date" prefWidth="95" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="timeCol" text="Time" prefWidth="70" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="guestsCol" text="Guests" prefWidth="60" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="codeCol" text="Code" prefWidth="130" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="statusCol" text="Status" prefWidth="90" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <placeholder>
                            <Label text="No reservations loaded" style="-fx-text-fill: #94a3b8; -fx-font-size: 14px;"/>
                        </placeholder>
                    </TableView>
                </VBox>

                <!-- Selected Code Display -->
                <HBox spacing="12" alignment="CENTER_LEFT" 
                      style="-fx-background-color: #f0f9ff; -fx-background-radius: 8; -fx-padding: 12;
                             -fx-border-color: #bae6fd; -fx-border-radius: 8;">
                    <Label text="Selected Code:" style="-fx-font-weight: 600; -fx-text-fill: #0369a1; -fx-font-size: 14px;"/>
                    <Label fx:id="selectedCodeLabel" text="â€”"
                           style="-fx-text-fill: #0c4a6e; -fx-font-weight: 700; -fx-font-size: 18px; -fx-font-family: 'Consolas';"/>
                </HBox>

                <!-- Seat Selected Button -->
                <Button text="âœ“ Seat with Selected Reservation"
                        onAction="#onSeatSelected"
                        styleClass="btn-success"
                        prefHeight="48"
                        maxWidth="Infinity"
                        style="-fx-font-size: 15px;"/>

                <!-- Status Label -->
                <Label fx:id="statusLabel2"
                       text=""
                       wrapText="true"
                       style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
            </VBox>

        </HBox>
    </center>
</BorderPane>